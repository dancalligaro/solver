

<script>

var piezas =[
	"100000011".split(""), 
	"000011000".split(""),
	"010000001".split(""), 
	"010000010".split("")
];

var huecos = [
	"byg0rwg0b".split(""),
	"0br0wy00g".split(""),
	"bry0gbyrw".split(""),
	"rgwy00wgb".split("")
];

var piezasDict = [{},{},{},{}]; //To check repeated chips

var allPiezas = [];

function rotate(pieza){
	var i,j,x,y,res = [];
	for(i=0;i<3;i++){
		for(j=0;j<3;j++){
			x = 2-i;
			y = j;
			res.push( pieza[ x + y * 3 ] );
		}
	}
	return res;
}

function flip(pieza){
	var i,j,x,y,res = [];
	for(i=0;i<3;i++){
		for(j=0;j<3;j++){
			x = 2-j;
			y = i;
			res.push( pieza[ x + y * 3 ] );
		}
	}
	return res;
}

var count = 100;

var objective = {
	y: 5
}

function calcularPermutaciones(){

	var i,j,k,l, perms = [];
	for(i=0;i<4;i++){
		for(j=0;j<4;j++){
			for(k=0;k<4;k++){
				for(l=0;l<4;l++){
					var test = {};
					test[0] = test[1] = test[2] = test[3] = 0;
					test[i] +=1;
					test[j] +=1;
					test[k] +=1;
					test[l] +=1;

					var ok = true;

					for(var h = 0; h<4; h++){
						if(test[h]>1){
							ok = false;
							continue;
						}
					}

					if(ok){
						perms.push([i,j,k,l]);
					}


				}
			}
		}
	}
	return perms;

}

var permutaciones = calcularPermutaciones();

//Al derecho:
function check(){
	cantResults = 0;

	var pix, rot, lastPieza;
	for(pix = 0; pix < permutaciones.length; pix++){

		var i,j,k,l;
		var pi, pj, pk, pl;

		for(i=0;i<8;i++){
			if(i==0){
				pi = piezas[permutaciones[pix][0]];
			} else if(i==4){
				pi = flip(piezas[permutaciones[pix][0]]);
			} else {
				pi = rotate(pi);
			}

			for(j=0;j<8;j++){
				if(j==0){
					pj = piezas[permutaciones[pix][1]];
				} else if(j==4){
					pj = flip(piezas[permutaciones[pix][1]]);
				} else {
					pj = rotate(pj);
				}

				for(k=0;k<8;k++){
					if(k==0){
						pk = piezas[permutaciones[pix][2]];
					} else if(k==4){
						pk = flip(piezas[permutaciones[pix][2]]);
					} else {
						pk = rotate(pk);
					}
					
					for(l=0;l<8;l++){
						if(l==0){
							pl = piezas[permutaciones[pix][3]];
						} else if(l==4){
							pl = flip(piezas[permutaciones[pix][3]]);
						} else {
							pl = rotate(pl);
						}

						if(matchObjective( [pi, pj, pk, pl] )){
							cantResults++;
							console.log('match: ', permutaciones[pix], "  rots: ", i,j,k,l );
						}

					}
				}
			}
		}

	}
	console.log("Cantidad Resultados", cantResults)

}



function matchObjective(pz){

	var i, key, match = {}

	for(i=0;i<4;i++){
		for(j=0;j<9;j++){
			if(pz[i][j] === "1"){
				match[huecos[i][j]] = match[huecos[i][j]] ? match[huecos[i][j]] + 1 : 1;
			}
		}
	}

	delete(match["0"])

	for(key in objective){
		if(match[key] && match[key] == objective[key]){
		}else{
			return false;
		}
	}

	for(key in match){
		if(objective[key] && match[key] == objective[key]){
			
		}else{
			return false;
		}
	}

	return true;

}

check();

console.log('end')

</script>


